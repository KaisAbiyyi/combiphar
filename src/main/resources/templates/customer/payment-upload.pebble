{# ========================================================================== #}
{# PAYMENT UPLOAD - Halaman upload bukti pembayaran                          #}
{# ========================================================================== #}
{% extends "customer/layout" %}

{% block styles %}
<link rel="stylesheet" href="/css/pages/customer/payment-upload.css">
{% endblock %}

{% block content %}
<section class="payment-upload">
  <div class="payment-upload__container">
    
    {# ================================================================== #}
    {# HEADER                                                             #}
    {# ================================================================== #}
    <div class="payment-upload__header">
      <h1>Unggah Bukti Pembayaran</h1>
      <p>Upload bukti transfer untuk verifikasi pembayaran Anda.</p>
    </div>

    <div class="payment-upload__content">
      
      {# ================================================================== #}
      {# UPLOAD FORM (LEFT)                                                #}
      {# ================================================================== #}
      <div class="upload-section">
        <div class="upload-card">
          <div class="upload-card__header">
            <h2>Upload File</h2>
          </div>
          
          <div class="upload-card__body">
            {# Upload Form #}
            <form id="uploadForm" class="upload-form" enctype="multipart/form-data">
              
              {# Bank Selection #}
              <div class="form-group">
                <label for="bankSelect" class="form-label">Pilih Bank Transfer <span class="text-danger">*</span></label>
                <select id="bankSelect" name="bank" class="form-select" required>
                  <option value="">-- Pilih Bank --</option>
                  <option value="BCA">BCA</option>
                  <option value="MANDIRI">Mandiri</option>
                  <option value="BRI">BRI</option>
                </select>
              </div>

              {# Dropzone Area #}
              <div class="upload-dropzone" id="dropzone">
                <div class="upload-dropzone__icon">üìÅ</div>
                <div class="upload-dropzone__text">
                  <p>Drag & drop file di sini</p>
                  <span>atau</span>
                </div>
                <label for="paymentProof" class="upload-dropzone__btn">
                  Pilih File
                </label>
                <input 
                  type="file" 
                  id="paymentProof" 
                  name="paymentProof"
                  accept="image/*,.pdf"
                  class="upload-dropzone__input"
                  required
                >
                <p class="upload-dropzone__hint">
                  Format: JPG, PNG, PDF (Maks. 5MB)
                </p>
              </div>

              {# Preview Area #}
              <div class="upload-preview" id="previewArea" style="display: none;">
                <div class="upload-preview__header">
                  <h4>File yang dipilih:</h4>
                  <button type="button" class="upload-preview__remove" id="removeFile">
                    ‚úï Hapus
                  </button>
                </div>
                <div class="upload-preview__content">
                  <img id="previewImage" src="" alt="Preview" style="display: none;">
                  <div id="previewFile" class="upload-preview__file" style="display: none;">
                    <span class="upload-preview__file-icon">üìÑ</span>
                    <span class="upload-preview__file-name" id="fileName"></span>
                  </div>
                </div>
              </div>

              {# Submit Button #}
              <button type="submit" class="btn btn--primary btn--full" id="submitBtn" disabled>
                Kirim Bukti Pembayaran
              </button>
            </form>

            {# Success Message (hidden by default) #}
            <div class="upload-success" id="successMessage" style="display: none;">
              <div class="upload-success__icon">‚úÖ</div>
              <h3>Bukti Pembayaran Terkirim!</h3>
              <p>Tim kami akan memverifikasi pembayaran Anda dalam 1x24 jam.</p>
              <a href="/history" class="btn btn--secondary">Lihat Riwayat Pesanan</a>
            </div>
          </div>
        </div>
      </div>

      {# ================================================================== #}
      {# ORDER SUMMARY (RIGHT)                                             #}
      {# ================================================================== #}
      <aside class="order-summary-section">
        <div class="order-summary">
          <div class="order-summary__header">
            <h3>Ringkasan Pesanan</h3>
            <span class="item-count">{{ cart.itemCount }} barang</span>
          </div>

          <div class="order-summary__items">
            {% for item in cart.items %}
            <div class="order-summary__item">
              <img src="{% if item.imageUrl is not null %}{{ item.imageUrl }}{% else %}/images/products/placeholder.png{% endif %}" alt="{{ item.itemName }}">
              <div class="order-summary__item-details">
                <h4>{{ item.itemName }}</h4>
                <p class="qty">Qty: {{ item.quantity }} unit</p>
              </div>
              <div class="order-summary__item-price">Rp {{ item.subtotal | numberformat("#,###") }}</div>
            </div>
            {% endfor %}
          </div>

          <div class="order-summary__breakdown">
            <div class="order-summary__row">
              <span class="label">Subtotal</span>
              <span class="value">Rp {{ orderSummary.subtotal | numberformat("#,###") }}</span>
            </div>
            <div class="order-summary__row">
              <span class="label">Biaya Pengiriman</span>
              <span class="value">Rp {{ orderSummary.shippingCost | numberformat("#,###") }}</span>
            </div>
          </div>

          <div class="order-summary__total">
            <span class="label">Total</span>
            <span class="value">Rp {{ orderSummary.totalPrice | numberformat("#,###") }}</span>
          </div>
        </div>

        {# Back Link #}
        <a href="/payment" class="back-link">‚Üê Kembali ke halaman transfer</a>
      </aside>

    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script src="/js/payment-upload.js"></script>
{% endblock %}
